# 项目任务清单

## 数据库设计
- [x] 创建订单表（orders）- 包含订单基本信息、状态、AI置信度
- [x] 创建订单项目表（order_items）- 包含产品编码、数量、规格等详细信息
- [x] 创建处理日志表（processing_log）- 记录邮件处理状态和AI识别结果
- [x] 创建邮箱配置表（email_config）- 存储IMAP配置和字段映射规则

## 后端核心功能
- [x] 邮件监听服务 - IMAP连接、30秒轮询、附件提取
- [x] Excel识别模块 - 使用LLM识别Excel表格内容
- [x] 图片识别模块 - 使用LLM Vision识别图片中的订单信息
- [x] 数据标准化引擎 - 字段映射、数据验证、异常检测
- [x] 订单管理API - 查询、更新、确认、拒绝订单
- [x] 处理日志API - 查询处理历史和错误信息
- [x] 仪表板API - 实时统计处理进度和成功率
- [x] 邮箱配置API - 管理IMAP配置和字段映射规则
- [x] 手动触发同步API - 支持手动触发邮件同步

## 前端管理界面
- [x] 仪表板页面 - 展示实时统计数据、处理进度、成功率
- [x] 订单列表页面 - 支持分页、过滤、排序、状态筛选
- [x] 订单详情页面 - 查看完整订单信息、原始数据、AI识别结果
- [x] 异常订单审核页面 - 高亮显示异常订单、支持手动修改和确认
- [x] 处理日志页面 - 查询处理历史、错误信息、AI响应
- [ ] 邮箱配置页面 - 配置IMAP连接、字段映射规则
- [x] 导航和布局 - 使用DashboardLayout实现侧边栏导航

## 测试和部署
- [x] 创建模拟邮件数据 - 生成不同格式的Excel和图片示例
- [x] 测试邮件监听服务 - 验证IMAP连接和附件提取
- [x] 测试AI识别准确率 - 验证不同格式的识别效果
- [x] 测试数据标准化 - 验证字段映射和数据验证
- [x] 测试异常处理流程 - 验证异常检测和人工审核
- [x] 编写单元测试 - 覆盖核心功能模块
- [x] 生成部署文档 - Docker配置、环境变量说明

## 新增功能
- [x] 创建邮箱配置页面 - 支持IMAP配置和字段映射规则管理

## 系统优化
- [x] 移除字段映射配置 - AI自主理解订单格式
- [x] 优化AI识别逻辑 - 无需预配置映射规则
- [x] 简化配置页面 - 仅保留必要的IMAP和业务规则配置
- [x] 更新数据库Schema - 移除fieldMapping字段

## 订单审核工作流增强
- [x] 创建订单批注表 - 记录运营人员的审核意见
- [x] 创建订单修改历史表 - 追踪订单字段的修改记录
- [x] 开发批注API - 添加、查询、删除批注
- [x] 开发修改历史API - 自动记录订单修改
- [x] 订单详情页面增加批注功能 - 支持添加和查看批注
- [x] 订单详情页面增加修改历史时间线 - 可视化展示修改记录

## 批量操作和统计分析
- [x] 扩展订单表支持附件URL存储
- [x] 开发批量确认订单API
- [x] 开发批量导出API（返回JSON数据）
- [x] 开发AI识别准确率统计API
- [x] 订单列表页面增加批量选择功能
- [x] 订单列表页面增加批量操作按钮
- [x] 仪表板增加AI识别准确率趋势图表
- [x] 订单详情页面增加邮件附件预览功能

## Bug修复
- [x] 修复数据库字段命名不一致问题 - 统一使用驼峰命名

## 真实邮箱连接测试准备
- [x] 实现邮件监听服务启动机制 - 在server/_core/index.ts中启动邮件监听
- [x] 实现IMAP配置联动 - 从数据库读取配置并传递给邮件监听服务
- [x] 实现测试连接功能 - 验证IMAP配置是否正确
- [x] 实现附件上传到S3 - 在邮件监听服务中调用storagePut上传附件
- [x] 完善错误处理和日志记录 - 添加详细的邮件监听日志和错误重试机制
- [x] 实现配置更新后自动重启监听服务

## Bug修复 - 配置保存问题
- [x] 修复邮箱配置页面保存后表单重置为默认值的问题

## Bug修复 - API返回HTML错误
- [x] 修夏Settings页面API查询返回HTML而非JSON的错误

## 用户体验改进 - IMAP配置
- [x] 添加常见邮箱服务商配置示例（163、QQ、Gmail等）
- [x] 添加授权码获取说明和链接
- [x] 优化IMAP连接失败的错误提示
- [x] 添加配置帮助文档链接

## Bug修复 - Settings页面API错误
- [x] 修夏Settings页面API Mutation和Query返回HTML的错误
## Bug修复 - Settings页面持续 API错误
- [x] 诊断并修夏Settings页面持续出现的API Mutation错误
